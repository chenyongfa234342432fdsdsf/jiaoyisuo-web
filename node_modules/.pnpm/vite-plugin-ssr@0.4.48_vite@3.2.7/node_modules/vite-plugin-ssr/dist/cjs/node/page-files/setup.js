"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const getPageFiles_1 = require("../../shared/getPageFiles");
const utils_1 = require("../utils");
const globalContext_1 = require("../globalContext");
const virtualModuleIdPageFiles_1 = require("../plugin/plugins/generateImportGlobs/virtualModuleIdPageFiles");
(0, getPageFiles_1.setPageFilesAsync)(getPageFilesExports);
async function getPageFilesExports() {
    const viteDevServer = (0, globalContext_1.getViteDevServer)();
    if (viteDevServer) {
        const pageFilesExports = await dev(viteDevServer);
        (0, utils_1.debugGlob)('Page files found: ', pageFilesExports);
        return pageFilesExports;
    }
    //const pageFilesExports = await distAutoImporterDisabled()
    (0, utils_1.assert)(false);
}
async function dev(viteDevServer) {
    (0, utils_1.assert)(viteDevServer);
    const moduleExports = await viteDevServer.ssrLoadModule(virtualModuleIdPageFiles_1.virtualModuleIdPageFilesServer);
    const pageFilesExports = moduleExports.default || moduleExports;
    (0, utils_1.assert)(pageFilesExports);
    return pageFilesExports;
}
/*
async function distAutoImporterDisabled(): Promise<unknown> {
}

async function dynamicImport(filePath: string): Promise<unknown> {
  return new Function('file', 'return import(file)')(pathToFileURL(filePath).href)
}
*/
