网易云信即时通讯 Web Elite SDK，为 web sdk 的下一代版本，提供完善的即时通信功能开发框架，屏蔽其内部复杂细节，对外提供较为简洁的 API 接口，方便第三方应用快速集成即时通信功能。

安装

```
npm install nim-web-sdk-ng@latest
```

## sdk 选择

sdk 默认提供以下几种形式

```
dist/
├── CHATROOM_BROWSER_SDK.js  聊天室浏览器适配版 UMD 格式
├── CHATROOM_MINIAPP_SDK.js  聊天室小程序适配版 UMD 格式
├── CHATROOM_UNIAPP_SDK.js   聊天室 UNIAPP 适配版 UMD 格式
├── NIM_BROWSER_SDK.js       IM 浏览器适配版 UMD 格式
├── NIM_MINIAPP_SDK.js       IM 小程序适配版 UMD 格式
├── NIM_UNIAPP_SDK.js        IM UNIAPP 适配版 UMD 格式
├── QCHAT_BROWSER_SDK.js     圈组浏览器适配版 UMD 格式
├── esm
│   ├── adapters.d.ts
│   ├── index.d.ts
│   ├── index.js             ESM 模式，汇总各模块的，ES Module 格式
```

注意：

1. 这里的小程序适配版，其实是指四种小程序：微信、头条、百度、支付宝
2. ESM 模式的 SDK，导出了 IM、聊天室、圈组三个 SDK，以及适配器，对体积有比较严格的需求的建议使用这个模式。

#### 基础引入例子

```js
// 若使用 IM 能力则引入
import NIM from 'nim-web-sdk-ng'
// 等效于
import NIM from 'nim-web-sdk-ng/dist/NIM_BROWSER_SDK'

// 若使用聊天室能力则引入
import Chatroom from 'nim-web-sdk-ng/dist/CHATROOM_BROWSER_SDK'

// 0.11.0 版开始支持单例模式获取实例, 在此之前通过 new 创建实例
const nim = NIM.getInstance(
  {
    debugLevel: 'debug',
    appkey: 'YOUR_APPKEY',
    account: 'YOUR_ACCOUNT',
    token: 'YOUR_TOKEN'
  },
  {}
)

// 0.11.0 版开始支持单例模式获取实例, 在此之前通过 new 创建实例
const chatroom = Chatroom.getInstance({
  debugLevel: 'debug',
  appkey: 'YOUR_APPKEY',
  account: 'YOUR_ACCOUNT',
  token: 'YOUR_TOKEN',
  isAnonymous: false,
  chatroomId: 'YOUR_CHATROOM_ID',
  chatroomAddresses: ['YOUR_CHATRROM_ADDR']
})

async function init() {
  try {
    if (nim.status === 'unconnected' || nim.status === 'waitReconnect') {
      await nim.connect()
    }
  } catch (err) {
    console.error('login failed cause', err)
  }

  try {
    if (chatroom.status === 'unconnected' || chatroom.status === 'waitReconnect') {
      await chatroom.connect()
    }
  } catch (err) {
    console.error('login failed cause', err)
  }
}

init()
```

#### ESM 模式的使用例子

**需要 version >= 0.6.1**，对于开发者有体积要求的需求，单独引入 上述 SDK，会使得代码总体积比较大，故而可以选用 ESM 形式引入。

IM 需要自行注册模块，和适配器。

参见 node_modules 里关于 esm 模块的 ts 定义来获知有多少种模块和适配器选择，最终希望开发者的工程能够 tree-shaking 掉不需要的模块。

```js
import { NIM, MsgService, SessionService } from 'nim-web-sdk-ng/dist/esm'
import browserAdapters from 'nim-web-sdk-ng/dist/esm/browserAdapters'
// import miniAdapters from 'nim-web-sdk-ng/dist/esm/miniAppAdapters'
// import uniAppAdapters from 'nim-web-sdk-ng/dist/esm/uniAppAdapters'

// ESM 模式，IM 依赖的能力需要自行注册，以便于不用的模块最后能被 tree-shaking 掉。
NIM.setAdapters(browserAppAdapters)
NIM.registerService(MsgService, 'msg')
NIM.registerService(SessionService, 'session')

// 0.11.0 版开始支持单例模式获取实例, 在此之前通过 new 创建实例
const nim = NIM.getInstance(
  {
    debugLevel: 'debug',
    appkey: 'YOUR_APPKEY',
    account: 'YOUR_ACCOUNT',
    token: 'YOUR_TOKEN'
  },
  {}
)

async function init() {
  try {
    if (nim.status === 'unconnected' || nim.status === 'waitReconnect') {
      await nim.connect()
    }
  } catch (err) {
    console.error('login failed cause', err)
  }
}

init()
```

而聊天室和圈组的 SDK，只需要注册适配器，不需要注册模块，因为其各模块在功能上是不可拆分的，所以全都合并在 SDK 中。

```js
import { Chatroom } from 'nim-web-sdk-ng/dist/esm'
import browserAdapters from 'nim-web-sdk-ng/dist/esm/browserAdapters'

Chatroom.setAdapters(browserAppAdapters)

// 0.11.0 版开始支持单例模式获取实例, 在此之前通过 new 创建实例
const chatroom = Chatroom.getInstance({
  debugLevel: 'debug',
  appkey: 'YOUR_APPKEY',
  account: 'YOUR_ACCOUNT',
  token: 'YOUR_TOKEN',
  isAnonymous: false,
  chatroomId: 'YOUR_CHATROOM_ID',
  chatroomAddresses: ['YOUR_CHATRROM_ADDR']
})

async function init() {
  try {
    if (chatroom.status === 'unconnected' || chatroom.status === 'waitReconnect') {
      await chatroom.connect()
    }
  } catch (err) {
    console.error('login failed cause', err)
  }
}

init()
```

## 使用指引目录

IM

- [快速开始](https://doc.yunxin.163.com/messaging-enhanced/docs/DQwMDE5MDk?platform=web)
- [初始化与登录](https://doc.yunxin.163.com/messaging-enhanced/docs/DE1MTcxNzg?platform=web)
- [消息收发](https://doc.yunxin.163.com/messaging-enhanced/docs/TQ2NTUxNTM?platform=web)
- [消息扩展](https://doc.yunxin.163.com/messaging-enhanced/docs/DYzMDAyMjg?platform=web)
- [会话](https://doc.yunxin.163.com/messaging-enhanced/docs/TgxNjczNzk?platform=web)
- [用户](https://doc.yunxin.163.com/messaging-enhanced/docs/Dc0Njg0NjY?platform=web)
- [好友](https://doc.yunxin.163.com/messaging-enhanced/docs/zc2MTk2MjE?platform=web)
- [订阅](https://doc.yunxin.163.com/messaging-enhanced/docs/TE2ODU3NjM?platform=web)
- [系统通知](https://doc.yunxin.163.com/messaging-enhanced/docs/DIyMDE2NDM?platform=web)
- [群组](https://doc.yunxin.163.com/messaging-enhanced/docs/DA4OTc3NDc?platform=web)
- [超级群](https://doc.yunxin.163.com/messaging-enhanced/docs/TY3MzM1ODg?platform=web)
- [uniapp 推送相关](https://doc.yunxin.163.com/messaging-enhanced/docs/TAwMTEyNzE?platform=web)

聊天室

- [聊天室](https://doc.yunxin.163.com/messaging-enhanced/docs/jM2MzczOTE?platform=web)

圈组

- [圈组](https://doc.yunxin.163.com/messaging-enhanced/docs/TczMjgzMzU?platform=web)

其他

- [API 参考](https://doc.yunxin.163.com/docs/interface/messaging-enhanced/web/typedoc/Latest/zh/NIM/index.html)
- [已知问题](https://doc.yunxin.163.com/messaging-enhanced/docs/jE5NTczNTI?platform=web)
- [更新日志](https://doc.yunxin.163.com/messaging-enhanced/docs/zMwOTk5MjI?platform=web)
