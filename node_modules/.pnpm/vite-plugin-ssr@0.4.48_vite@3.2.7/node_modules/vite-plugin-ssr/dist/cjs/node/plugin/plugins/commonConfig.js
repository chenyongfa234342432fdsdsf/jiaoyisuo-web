"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.commonConfig = void 0;
function commonConfig() {
    return {
        name: 'vite-plugin-ssr:commonConfig',
        config: () => ({ appType: 'custom' }),
        configResolved(config) {
            setDefaultPort(config);
            workaroundCI(config);
        }
    };
}
exports.commonConfig = commonConfig;
function setDefaultPort(config) {
    var _a, _b;
    // @ts-ignore
    config.server ?? (config.server = {});
    (_a = config.server).port ?? (_a.port = 3000);
    // @ts-ignore
    config.preview ?? (config.preview = {});
    (_b = config.preview).port ?? (_b.port = 3000);
}
// Workaround GitHub Action failing to access the server
function workaroundCI(config) {
    var _a, _b;
    if (process.env.CI) {
        (_a = config.server).host ?? (_a.host = true);
        (_b = config.preview).host ?? (_b.host = true);
    }
}
